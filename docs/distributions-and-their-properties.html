<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lecture 5 Distributions and their properties | Fundamentals of Biological Data Analysis</title>
<meta name="author" content="Dmitry Kondrashov and Stefano Allesina">
<meta name="description" content="5.1 Objectives: Apply concepts of conditional probability to practical scenarios and questions Describe independence as a concept and apply to data sets Use random number generators to simulate...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Lecture 5 Distributions and their properties | Fundamentals of Biological Data Analysis">
<meta property="og:type" content="book">
<meta property="og:description" content="5.1 Objectives: Apply concepts of conditional probability to practical scenarios and questions Describe independence as a concept and apply to data sets Use random number generators to simulate...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lecture 5 Distributions and their properties | Fundamentals of Biological Data Analysis">
<meta name="twitter:description" content="5.1 Objectives: Apply concepts of conditional probability to practical scenarios and questions Describe independence as a concept and apply to data sets Use random number generators to simulate...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Biological Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Organization of the class</a></li>
<li><a class="" href="refresher.html"><span class="header-section-number">1</span> Refresher</a></li>
<li><a class="" href="visualizing-data-using-ggplot2.html"><span class="header-section-number">2</span> Visualizing data using ggplot2</a></li>
<li><a class="" href="fundamentals-of-probability.html"><span class="header-section-number">3</span> Fundamentals of probability</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">4</span> Data wrangling</a></li>
<li><a class="active" href="distributions-and-their-properties.html"><span class="header-section-number">5</span> Distributions and their properties</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">6</span> Hypothesis testing</a></li>
<li><a class="" href="likelihood-and-bayes.html"><span class="header-section-number">7</span> Likelihood and Bayes</a></li>
<li><a class="" href="review-of-linear-algebra.html"><span class="header-section-number">8</span> Review of linear algebra</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">9</span> Linear models</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">10</span> ANOVA</a></li>
<li><a class="" href="model-selection.html"><span class="header-section-number">11</span> Model Selection</a></li>
<li><a class="" href="principal-component-analysis.html"><span class="header-section-number">12</span> Principal Component Analysis</a></li>
<li><a class="" href="clustering.html"><span class="header-section-number">13</span> Clustering</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">14</span> Generalized linear models</a></li>
<li><a class="" href="machine-learning-methods-for-classification.html"><span class="header-section-number">15</span> Machine learning methods for classification</a></li>
<li><a class="" href="building-phylogeneric-trees.html"><span class="header-section-number">16</span> Building phylogeneric trees</a></li>
<li><a class="" href="time-series-modeling-and-forecasting.html"><span class="header-section-number">17</span> Time series: modeling and forecasting</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="distributions-and-their-properties" class="section level1" number="5">
<h1>
<span class="header-section-number">Lecture 5</span> Distributions and their properties<a class="anchor" aria-label="anchor" href="#distributions-and-their-properties"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Objectives:<a class="anchor" aria-label="anchor" href="#objectives"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Apply concepts of conditional probability to practical scenarios and questions</li>
<li>Describe independence as a concept and apply to data sets</li>
<li>Use random number generators to simulate various distributions</li>
<li>Be familiar with the shape of several common distributions and describe the role of their parameters</li>
</ul>
</div>
<div id="independence" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Independence<a class="anchor" aria-label="anchor" href="#independence"><i class="fas fa-link"></i></a>
</h2>
<div id="conditional-probability" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Conditional probability<a class="anchor" aria-label="anchor" href="#conditional-probability"><i class="fas fa-link"></i></a>
</h3>
<p>In the basic definitions of probability, we considered the probabilities of each outcome and events separately. Let us consider how information about one event affects the probability of another event. The concept is that if one event (let’s call it <span class="math inline">\(B\)</span>) is true, unless the event is the entire space, it rules out some other outcomes. This may affect the probability of other events (e.g., <span class="math inline">\(A\)</span>) in the sample space, because knowledge of <span class="math inline">\(B\)</span> may rule out some of the outcomes in <span class="math inline">\(A\)</span> as well. Here is the formal definition:</p>
<blockquote>
<p><strong>Definition</strong>: For two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> in a sample space <span class="math inline">\(\Omega\)</span> with a probability measure <span class="math inline">\(P\)</span>, the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>, called the <strong>conditional probability</strong>, defined as:</p>
</blockquote>
<p><span class="math inline">\(P(A \vert B) = \frac{P(A \cap B)}{P(B)}\)</span></p>
<blockquote>
<p>where <span class="math inline">\(A \cap B\)</span> or <span class="math inline">\(A, B\)</span> is the intersection of events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, also known as “<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>”—the event consisting of all outcomes that are in both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
</blockquote>
<p>In words, given the knowledge that an event <span class="math inline">\(B\)</span> occurs, the sample space is restricted to the subset <span class="math inline">\(B\)</span>, which is why the denominator in the definition is <span class="math inline">\(P(B)\)</span>. The numerator encompasses all the outcomes we are interested in, (i.e., <span class="math inline">\(A\)</span>), but since we are now restricted to <span class="math inline">\(B\)</span>, the numerator consists of all the outcomes of <span class="math inline">\(A\)</span> which are also in <span class="math inline">\(B\)</span>, or <span class="math inline">\(A \cap B\)</span>. The definition makes sense in two extreme cases: if <span class="math inline">\(A = B\)</span> and if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive:</p>
<p><span class="math inline">\(P(B\vert B) = P(B \cap B) /P(B) = P(B)/P(B) = 1\)</span></p>
<p>If <span class="math inline">\(P(A\cap B) = 0\)</span>, then <span class="math inline">\(P(A\vert B) = 0/P(B) = 0\)</span></p>
<p><strong>Important note:</strong> one common source of confusion about conditional probability is the difference between the probability of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span>. This is a result of the discrepancy between everyday word usage and mathematical terminology, because the statement “what are the odds of finding a tall person who also likes tea?” is hard to distinguish from “what are the odds that a person who is tall likes tea?” The critical difference between these two statements is that in the former you start out with no information and are picking out a person from the entire population, while is in the latter you start out with the knowledge that a person is tall.</p>
<p><strong>Example:</strong> In the classic Mendelian pea experiment, each diploid organism carries two alleles. The allele <span class="math inline">\(A\)</span> is dominant and results in pink flowers, while <span class="math inline">\(a\)</span> is recessive and results in white flowers. There are three possible genotypes (<span class="math inline">\(AA\)</span>, <span class="math inline">\(Aa\)</span>, <span class="math inline">\(aa\)</span>) and two phenotypes (Pink or White). For the questions below, assume that two heterozygous pea plants (each having genotype <span class="math inline">\(Aa\)</span>) are crossed, producing the following table of genotypes with equal probabilities in each cell:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>parent</th>
<th>A</th>
<th>a</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>AA (pink)</td>
<td>Aa (pink)</td>
</tr>
<tr class="even">
<td>a</td>
<td>Aa (pink)</td>
<td>aa (white)</td>
</tr>
</tbody>
</table></div>
<ol style="list-style-type: decimal">
<li><p>What is the probability that a plant with pink flowers has genotype <span class="math inline">\(AA\)</span>? Write this down in terms of conditional probability and explain how it’s different from the probability of a plant having both pink flower and genotype <span class="math inline">\(AA\)</span>.</p></li>
<li><p>What is the probability that a plant with genotype <span class="math inline">\(AA\)</span> has pink flowers? Again, write down the conditional probability and explain how it’s different from the probability of a plant having both pink flower and genotype <span class="math inline">\(AA\)</span>.</p></li>
</ol>
<p><strong>Lesson:</strong> in general,
<span class="math display">\[P(X \vert  Y ) \neq P(Y \vert  X)\]</span></p>
</div>
<div id="independence-1" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Independence<a class="anchor" aria-label="anchor" href="#independence-1"><i class="fas fa-link"></i></a>
</h3>
<p>Independence is a fundamental concept in probability that may be misinterpreted without careful thinking. Intuitively, two events (or random variables) are independent if one does not influence the other. More precisely, it means that the probability of one event is the same regardless of whether the other one happens or not. This is expressed precisely using conditional probabilities:</p>
<blockquote>
<p><strong>Definition</strong>: Two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> in a sample space <span class="math inline">\(\Omega\)</span> with a probability measure <span class="math inline">\(P\)</span> are <strong>independent</strong> if <span class="math inline">\(P(A\vert B) = P(A)\)</span>, or equivalently if <span class="math inline">\(P(B\vert A) = P(B)\)</span>.</p>
</blockquote>
<p>Independence is not a straightforward concept. It may be confused with mutual exclusivity, as one might surmise that if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> have no overlap, then they are independent. That however, is false by definition, since <span class="math inline">\(P(A\vert B)\)</span> is 0 for two mutually exclusive events. The confusion stems from thinking that if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are non-overlapping, then they do not influence each other. But the notion of influence in this definition is about information; so if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are mutually exclusive, the knowledge that one of them occurs has an influence of the probability of the other one occurring, specifically it rules the other one out.</p>
<p><strong>Example:</strong> In the sample space of weather phenomena, are the events of snowing and hot weather independent?</p>
<p><strong>Example:</strong> A slightly more subtle example, the lifetime risk of breast cancer is about 1 in 8 for women and about 1 in 1000 for men. Are sex and breast cancer independent?</p>
</div>
<div id="usefulness-of-independence" class="section level3" number="5.2.3">
<h3>
<span class="header-section-number">5.2.3</span> Usefulness of independence<a class="anchor" aria-label="anchor" href="#usefulness-of-independence"><i class="fas fa-link"></i></a>
</h3>
<p>Independence is a mathematical abstraction, and reality rarely provides us with perfectly independent variables. But it’s a very useful abstraction in that it enables calculations that would be difficult or impossible to carry out without this assumption.</p>
<p>First, independence allows for calculating the probability of two events or two random variables simultaneously. This is a straightforward consequence of the definition conditional probability (first equality) and independence (second equality):</p>
<p><span class="math display">\[\frac{P(A \cap B)}{P(B)}= P(A\vert B) = P(A)\]</span>
Multiplying both sides by <span class="math inline">\(P(B)\)</span>, we get the <strong>product rule</strong> of independence, perhaps the most widely used formula in applied probability:</p>
<p><span class="math display">\[P(A \cap B) = P(A)P(B)\]</span></p>
<p><strong>Example:</strong> The probability that two randomly selected individuals have red hair–assuming that the occurrence of this trait is independent–is the square of the probability of red hair in one individual. (Note that this is never exactly the case for a finite population—why?)</p>
<p><strong>Example:</strong> The probability of two alleles of two separate genes (call them A and B) occurring on the same gamete may be independent or may be linked. In population genetics, the concept of <em>linkage disequilibrium</em> describes the extent of such linkage; for example, alleles that are located on separate chromosomes (in eukaryotes) are usually not linked and their occurrence is independent. The <em>coefficient of linkage disequilibrium</em> is defined as the difference between what is expected from independence and the actual probability of both alleles being present:
<span class="math display">\[D_{AB} = P(A \cap B) - P(A)P(B) \]</span>
<span class="math inline">\(P(A)\)</span> and <span class="math inline">\(P(B)\)</span> are the frequencies of the two respective alleles (haplotypes) in the population, while <span class="math inline">\(P(A \cap B)\)</span> is the frequency of the haplotypes occurring together in the same copy of the genome (that is, on the same gamete). For two independent loci, <span class="math inline">\(D_{AB} = 0\)</span>, while for loci that usually occur together the coefficient will be positive, and its magnitude is influenced both by physical proximity of the loci on a chromosome, the evolutionary history of the species, and other factors.</p>
<p>Another important consequence of independence has to do with the sum of two independent random variables. The expectation of the sum of any random variables is linear, which can be demonstrated using some work with sums, starting from the definition of expectation (the same can be shown for continuous random variables, using integrals instead of sums):</p>
<p><span class="math display">\[E(X + Y) = \sum_i \sum_j (x_i + y_j) P(x_i, y_j) =\]</span></p>
<p><span class="math display">\[= \sum_i \sum_j x_iP(x_i, y_j) + \sum_i \sum_j y_j P(x_i, y_j) = \sum_i x_i \sum_j P(x_i, y_j) + \sum_j y_j \sum_i  P(x_i, y_j) = \]</span>
Summing up a joint probability distribution over all values of one variable removes that variable, <span class="math inline">\(\sum_j P(x_i, y_j) = P(x_i)\)</span> <span class="math inline">\(\sum_i P(x_i, y_j) = P(y_j)\)</span>, so this leave us with the two separate expected values:</p>
<p><span class="math display">\[= \sum_i x_i P(x_i) + \sum_j y_j P(y_j) = E(X) + E(Y)\]</span>
However, this is not the case for the variance in general (using <span class="math inline">\(E_X\)</span> and <span class="math inline">\(E_Y\)</span> to indicate the expected values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to reduce the number of parentheses):</p>
<p><span class="math display">\[\text{Var}(X+Y) = E \left[ (X+Y)-(E_X+E_Y) \right]^2 = \]</span>
<span class="math display">\[=E[ (X-E_X)^2 +(Y-E_Y)^2 - 2(X-E_X)(Y-E_Y)] =  \]</span>
<span class="math display">\[=E (X-E_X)^2 +  E(Y-E_Y)^2 - 2 E[(X-E_X)(Y-E_Y)]  = \]</span>
The first two terms are the respective variances, while the third term is called the <em>covariance</em> of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[= \text{Var}(X) + \text{Var}(Y) - 2 \text{Cov}(X,Y) \]</span>
Covariance describes how much two random variables vary together, or more precisely, how much they deviate from their respective means in the same direction. Thus it should be reasonable to think that two independent random variables have covariance 0, which is demonstrated as follows:</p>
<p><span class="math display">\[E[(X-E_X)(Y-E_Y)] = E(XY) - E_Y E_X - E_YE_X + E_XE_Y = E(XY) - E_X E_Y  \]</span></p>
<p>We can write the expression for the expectation of the random variable comprised of all pairs of values of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, using the fact that for two independent random variables, <span class="math inline">\(P(x_i,y_j) = P(x_i)P(y_j)\)</span> for all values <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_j\)</span>:</p>
<p><span class="math display">\[E(XY) = \sum_i \sum_j x_iy_j P(x_i,y_j) = \sum_i x_i P(x_i) \sum_j y_j P(y_j) = E_X E_Y\]</span>
The calculation for two continuous random variables is analogous, only with integrals instead of sums.</p>
<p>This demonstrates that the covariance of two independent random variables is 0, and thus that the variance of a sum of two independent random variables is the sum of the two separate variables.</p>
<p><strong>Example:</strong> This property of variance is often used in analysis of noise or error in data. It is commonly assumed in least squares fitting that noise in data is independent of the signal or model underlying the data. This is the foundation for statements like “this linear regression explains 80% of the variance in the data.”</p>
</div>
</div>
<div id="probability-distribution-examples-discrete" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Probability distribution examples (discrete)<a class="anchor" aria-label="anchor" href="#probability-distribution-examples-discrete"><i class="fas fa-link"></i></a>
</h2>
<p>The following are examples of distributions of random variables with discrete values. The first two have finite support (finitely many values) while the second two have infinite support.</p>
<div id="uniform" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> Uniform<a class="anchor" aria-label="anchor" href="#uniform"><i class="fas fa-link"></i></a>
</h3>
<p>The simplest probability distribution in which every value has the same probability (and one which is sometimes called “purely random” even though any random variable with any distribution is just as random). The probability distribution for a uniform random variable with <span class="math inline">\(n\)</span> values is <span class="math inline">\(P(x) = 1/n\)</span> for any value <span class="math inline">\(x\)</span>.</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># maximum value</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">low</span><span class="op">:</span><span class="va">high</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">num</span>, <span class="va">num</span><span class="op">)</span> <span class="co"># uniform mass function vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">probs</span>, names.arg <span class="op">=</span> <span class="va">values</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"uniform  distribution on integers from "</span>, <span class="va">low</span>, <span class="st">"to "</span>, <span class="va">high</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-147-1.png" width="672"></div>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unif.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">values</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of uniform distribution is"</span>, <span class="va">unif.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of uniform distribution is 5"</code></pre>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unif.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">unif.exp</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of uniform distribution is"</span>, <span class="va">unif.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of uniform distribution is 10"</code></pre>
<p><em>Exercise:</em> experiment with the low and high values to see how the expectation and variance depend on them. Can you postulate a relationship without looking it up?</p>
</div>
<div id="binomial" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> Binomial<a class="anchor" aria-label="anchor" href="#binomial"><i class="fas fa-link"></i></a>
</h3>
<p>Binary or Bernoulli trials have two discrete outcomes (mutant/wild-type, win/lose, etc.). The number of “successes” out of a sequence of <span class="math inline">\(n\)</span> independent binary trials with probability of success <span class="math inline">\(p\)</span> is described by the binomial distribution.</p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># the number of trials</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># the probability of success in one trial</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span> <span class="co"># vector of discrete values of the binomial</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">probs</span>, names.arg <span class="op">=</span> <span class="va">values</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"binomial distribution with n="</span>, <span class="va">n</span>, <span class="st">"and p="</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-149-1.png" width="672"></div>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">values</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of binomial distribution is"</span>, <span class="va">bin.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of binomial distribution is 3"</code></pre>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">bin.exp</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of binomial distribution is"</span>, <span class="va">bin.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of binomial distribution is 2.1"</code></pre>
<p><em>Exercise:</em> Try different values of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> and postulate a relationship with the expectation and variance.</p>
</div>
<div id="geometric" class="section level3" number="5.3.3">
<h3>
<span class="header-section-number">5.3.3</span> Geometric<a class="anchor" aria-label="anchor" href="#geometric"><i class="fas fa-link"></i></a>
</h3>
<p>The random variable is the first “success” in a string of independent binary trials and the distribution describes the probability of any non-negative value. It may be pretty intuitive that since all the trials have the same probability of success, the distribution with have a geometric (exponential) form—try to figure out the exact formula for the probability density without looking it up!</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># the probability of success</span></span>
<span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># maximum value</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">low</span><span class="op">:</span><span class="va">high</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html">dgeom</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">probs</span>, names.arg <span class="op">=</span> <span class="va">values</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"geometric distribution with p="</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-151-1.png" width="672"></div>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geom.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">values</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of geometric distribution is"</span>, <span class="va">geom.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of geometric distribution is 2.32030059650472"</code></pre>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geom.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">geom.exp</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of geometric distribution is"</span>, <span class="va">geom.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of geometric distribution is 7.52697882945385"</code></pre>
<p><em>Exercise:</em> Calculate the expectations and variances for different values of <span class="math inline">\(p\)</span> and report how they are related.</p>
</div>
<div id="poisson" class="section level3" number="5.3.4">
<h3>
<span class="header-section-number">5.3.4</span> Poisson<a class="anchor" aria-label="anchor" href="#poisson"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose that there is a discrete process that occurs with some average rate <span class="math inline">\(\lambda\)</span>, which describes the expected number of occurrences of these events in a unit of time. The Poisson random variable is the number of such occurrences, and the distribution describes the probability of any non-negative value.</p>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># maximum value</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># Poisson rate</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">low</span><span class="op">:</span><span class="va">high</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">probs</span>, names.arg <span class="op">=</span> <span class="va">values</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Poisson distribution with lambda="</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-153-1.png" width="672"></div>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pois.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">values</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of Poisson distribution is"</span>, <span class="va">pois.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of Poisson distribution is 9.96545658024143"</code></pre>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pois.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">pois.exp</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of Poisson distribution is"</span>, <span class="va">pois.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of Poisson distribution is 9.77875058489889"</code></pre>
<p><em>Exercise:</em> Calculate the expectations and variances for different values of <span class="math inline">\(\lambda\)</span> and report how they are related.</p>
</div>
</div>
<div id="probability-distribution-examples-continuous" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Probability distribution examples (continuous)<a class="anchor" aria-label="anchor" href="#probability-distribution-examples-continuous"><i class="fas fa-link"></i></a>
</h2>
<p>In the following examples with continuous variables we cannot calculate the means and variances directly from the density function. One way to do it is to produce a sample using the random number generator and calculate the mean and variance of that sample.</p>
<div id="uniform-1" class="section level3" number="5.4.1">
<h3>
<span class="header-section-number">5.4.1</span> Uniform<a class="anchor" aria-label="anchor" href="#uniform-1"><i class="fas fa-link"></i></a>
</h3>
<p>The continuous equivalent of the discrete uniform distribution.</p>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># maximum values</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">low</span>, <span class="va">high</span>, length.out <span class="op">=</span> <span class="va">number</span><span class="op">)</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">dunif</a></span><span class="op">(</span><span class="va">values</span>, min<span class="op">=</span><span class="va">low</span>, max <span class="op">=</span> <span class="va">high</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">probs</span>, t<span class="op">=</span><span class="st">'l'</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'density'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Uniform distribution on interval from "</span>, <span class="va">low</span>, <span class="st">"to "</span>, <span class="va">high</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-155-1.png" width="672"></div>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># sample size</span></span>
<span><span class="va">unif.sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">low</span>, <span class="va">high</span><span class="op">)</span> <span class="co"># generate sample</span></span>
<span><span class="va">unif.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">unif.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of uniform distribution is"</span>, <span class="va">unif.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of uniform distribution is 5.06540985442465"</code></pre>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unif.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">unif.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of uniform distribution is"</span>, <span class="va">unif.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of uniform distribution is 8.30620526940778"</code></pre>
<p><em>Exercise:</em> experiment with the width of the interval to see how it affects the expectation and variance.</p>
</div>
<div id="exponential" class="section level3" number="5.4.2">
<h3>
<span class="header-section-number">5.4.2</span> exponential<a class="anchor" aria-label="anchor" href="#exponential"><i class="fas fa-link"></i></a>
</h3>
<p>The random variable describes the length of time between independent discrete events occurring with a certain rate, like we saw in the Poisson distribution.</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># maximum values</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">low</span>,<span class="va">high</span>,length.out <span class="op">=</span> <span class="va">number</span><span class="op">)</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">dexp</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">probs</span>, t<span class="op">=</span><span class="st">'l'</span>, xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'density'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Exponential distribution with rate="</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-157-1.png" width="672"></div>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># sample size</span></span>
<span><span class="va">exp.sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">r</span><span class="op">)</span> <span class="co"># generate sample</span></span>
<span><span class="va">exp.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">exp.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of exponential distribution is"</span>, <span class="va">exp.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of exponential distribution is 2.01850378726749"</code></pre>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">exp.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of exponential distribution is"</span>, <span class="va">exp.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of exponential distribution is 3.83941422118433"</code></pre>
<p><em>Exercise:</em> What is the relationship between the rate and the expectation and variance?</p>
</div>
<div id="normal-distribution" class="section level3" number="5.4.3">
<h3>
<span class="header-section-number">5.4.3</span> normal distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>The normal distribution, sometimes written <span class="math inline">\(N(\mu, \sigma)\)</span> comes up everywhere (e.g., in the limit of the Poisson distribution for large <span class="math inline">\(n\)</span>). The two parameters are simply the mean and the standard deviation. The reason for its ubiquity is that it is that any sum of a large number of independent random variables converges to the normal, formalized by the Central Limit Theorem:</p>
<blockquote>
<p>For a set of <span class="math inline">\(n\)</span> IID random variables <span class="math inline">\(\{X_i\}\)</span> with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>, the sample mean <span class="math inline">\(\bar X_n\)</span> has the property:
<span class="math display">\[
\lim_{n \to \infty} = \frac{\bar X_n - \mu}{\sigma} = N(0,1)
\]</span>
where <span class="math inline">\(N(0,1)\)</span> stands for the normal distribution with mean 0 and standard deviation 1.</p>
</blockquote>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># minimum value</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># maximum values</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> </span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">low</span>,<span class="va">high</span>,length.out <span class="op">=</span> <span class="va">number</span><span class="op">)</span> <span class="co"># vector of discrete values of the RV</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">probs</span>, t<span class="op">=</span><span class="st">'l'</span>,xlab <span class="op">=</span> <span class="st">'values'</span>, ylab <span class="op">=</span> <span class="st">'density'</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Normal distribution with mean="</span>, <span class="va">mu</span>, <span class="st">"and sigma="</span>, <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-159-1.png" width="672"></div>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># sample size</span></span>
<span><span class="va">norm.sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span> <span class="co"># generate sample</span></span>
<span><span class="va">norm.exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">norm.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The expected value of normal distribution is"</span>, <span class="va">norm.exp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The expected value of normal distribution is 5.00768941373441"</code></pre>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">norm.sample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The variance of normal distribution is"</span>, <span class="va">norm.var</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "The variance of normal distribution is 0.237997327122373"</code></pre>
</div>
</div>
<div id="application-of-normal-distribution-confidence-intervals" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Application of normal distribution: confidence intervals<a class="anchor" aria-label="anchor" href="#application-of-normal-distribution-confidence-intervals"><i class="fas fa-link"></i></a>
</h2>
<p>The most important use of the normal distribution has to do with estimation of means, because the normal distribution describes the <em>sampling distributions</em> of means of IID samples. The mean of that sampling distribution is the mean of the population distribution that is being sampled, and the standard deviation is called the <em>standard error</em> and is related to the standard deviation of the population <span class="math inline">\(\sigma_X\)</span> as follows: <span class="math inline">\(\sigma_{SE} = \sigma/n\)</span>, where <span class="math inline">\(n\)</span> is the sample size.</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numsamples</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># compute mean for different samples</span></span>
<span><span class="va">samplemeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">numsamples</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="va">size</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">break_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span>, </span>
<span>                    <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">samplemeans</span>, breaks <span class="op">=</span> <span class="va">break_points</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>     cex.axis <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>     main<span class="op">=</span> <span class="st">'1000 means of samples of size 100'</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">samplemeans</span><span class="op">)</span>, <span class="va">sigma</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">range</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">range</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>      t <span class="op">=</span> <span class="st">'l'</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, cex.axis <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-161-1.png" width="672"></div>
<p><em>Exercise:</em> Try using different distributions from above and see if the sample means still converge to the normal distribution.</p>
<p>The following script calculates a confidence interval based on a sample.</p>
<div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Computing confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># the value that divides the density function in two</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span> <span class="co"># the value such that 95% of density is to its left </span></span></code></pre></div>
<pre><code>## [1] 1.644854</code></pre>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># sample size</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.95</span> <span class="co"># significance level</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="co"># standard error</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># z-value</span></span>
<span><span class="va">left</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">+</span> <span class="va">s</span> <span class="op">*</span> <span class="va">z</span></span>
<span><span class="va">right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span> <span class="op">-</span> <span class="va">s</span> <span class="op">*</span> <span class="va">z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">right</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.5843578</code></pre>
<div class="sourceCode" id="cb417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">left</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.4666318</code></pre>
<p><em>Exercise:</em> Modify that script to report whether the confidence interval captures the true mean. Use a loop structure (as in the script above) to generate 1000 sample means and report how many of them are within the theoretical confidence interval. Does this match the fraction you expect from the significance level? Try different significance levels and sample sizes and report what you discover.</p>
</div>
<div id="identifying-type-of-distribution-in-real-data" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Identifying type of distribution in real data<a class="anchor" aria-label="anchor" href="#identifying-type-of-distribution-in-real-data"><i class="fas fa-link"></i></a>
</h2>
<p>Let us consider the penguin data set again:</p>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code>## tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
##  $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
##  $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...
##  $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<p>A simple way to visualize a distribution is to plot a histogram: data are binned, and the height of the bin represents counts (or frequencies). Here are the histograms of distributions of flipper lengths of all the species of penguins separated by sex:</p>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, color <span class="op">=</span> <span class="va">sex</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-164-1.png" width="672"></div>
<p>And here are the histograms of flipper lengths separated by species:</p>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, color <span class="op">=</span> <span class="va">species</span>, fill<span class="op">=</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-165-1.png" width="672"></div>
<p>To decide systematically which of these distributions are closer to a theoretical distribution is via a Quantile-Quantile (QQ) plot, which plots the quantile value from a sample against the quantiles from a given distribution with best-fit parameters. If the data were to follow the distribution closely, you should find all the points lying on the identity line. For example, here is how to compare a data set drawn from the normal random number generator with the normal distribution:</p>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus">fitdistrplus</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># example: find best-fitting Normal</span></span>
<span><span class="va">my_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html">fitdistr</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">x</span>, densfun <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co"># note the slight discrepancies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_normal</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       mean          sd    
##   3.03809459   1.48753761 
##  (0.06652470) (0.04704007)</code></pre>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">test_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Q-Q plot assuming best-fitting Normal distribution"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-166-1.png" width="672">
Now let us assess the “normality” of the flipper length data separated by sex and separated by species:</div>
<div class="sourceCode" id="cb432"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'female'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> </span>
<span><span class="va">my_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html">fitdistr</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/as_vector.html">as_vector</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>, densfun <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co"># note the slight discrepancies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_normal</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       mean           sd     
##   197.3636364    12.4628373 
##  (  0.9702306) (  0.6860566)</code></pre>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Q-Q plot assuming best-fitting Normal distribution of flipper lenth for female penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-167-1.png" width="672"></div>
<div class="sourceCode" id="cb435"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">'male'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> </span>
<span><span class="va">my_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html">fitdistr</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/as_vector.html">as_vector</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>, densfun <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co"># note the slight discrepancies</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_normal</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       mean           sd     
##   204.5059524    14.5045137 
##  (  1.1190475) (  0.7912861)</code></pre>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">qnorm</span>, dparams <span class="op">=</span> <span class="va">my_normal</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Q-Q plot assuming best-fitting Normal distribution of flipper lenth for male penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-167-2.png" width="672"></div>
<p>In contrast with the simulated data, here the data points and the black line that attempts to capture them is quite different from the identity line (red). This means this distribution is for from normal, as can be seen from the histograms of the flipper lengths grouped by sex.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data-wrangling.html"><span class="header-section-number">4</span> Data wrangling</a></div>
<div class="next"><a href="hypothesis-testing.html"><span class="header-section-number">6</span> Hypothesis testing</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#distributions-and-their-properties"><span class="header-section-number">5</span> Distributions and their properties</a></li>
<li><a class="nav-link" href="#objectives"><span class="header-section-number">5.1</span> Objectives:</a></li>
<li>
<a class="nav-link" href="#independence"><span class="header-section-number">5.2</span> Independence</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conditional-probability"><span class="header-section-number">5.2.1</span> Conditional probability</a></li>
<li><a class="nav-link" href="#independence-1"><span class="header-section-number">5.2.2</span> Independence</a></li>
<li><a class="nav-link" href="#usefulness-of-independence"><span class="header-section-number">5.2.3</span> Usefulness of independence</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#probability-distribution-examples-discrete"><span class="header-section-number">5.3</span> Probability distribution examples (discrete)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#uniform"><span class="header-section-number">5.3.1</span> Uniform</a></li>
<li><a class="nav-link" href="#binomial"><span class="header-section-number">5.3.2</span> Binomial</a></li>
<li><a class="nav-link" href="#geometric"><span class="header-section-number">5.3.3</span> Geometric</a></li>
<li><a class="nav-link" href="#poisson"><span class="header-section-number">5.3.4</span> Poisson</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#probability-distribution-examples-continuous"><span class="header-section-number">5.4</span> Probability distribution examples (continuous)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#uniform-1"><span class="header-section-number">5.4.1</span> Uniform</a></li>
<li><a class="nav-link" href="#exponential"><span class="header-section-number">5.4.2</span> exponential</a></li>
<li><a class="nav-link" href="#normal-distribution"><span class="header-section-number">5.4.3</span> normal distribution</a></li>
</ul>
</li>
<li><a class="nav-link" href="#application-of-normal-distribution-confidence-intervals"><span class="header-section-number">5.5</span> Application of normal distribution: confidence intervals</a></li>
<li><a class="nav-link" href="#identifying-type-of-distribution-in-real-data"><span class="header-section-number">5.6</span> Identifying type of distribution in real data</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Biological Data Analysis</strong>" was written by Dmitry Kondrashov and Stefano Allesina. It was last built on 2022-10-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
