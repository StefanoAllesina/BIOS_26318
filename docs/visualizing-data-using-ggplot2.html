<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lecture 2 Visualizing data using ggplot2 | Fundamentals of Biological Data Analysis</title>
<meta name="author" content="Dmitry Kondrashov and Stefano Allesina">
<meta name="description" content="2.1 Goal Introduce the package ggplot2, which is part of the tidyverse bundle. Learn how to use ggplot2 to produce publication-quality figures. Discuss the philosophical underpinnings of the...">
<meta name="generator" content="bookdown 0.24.1 with bs4_book()">
<meta property="og:title" content="Lecture 2 Visualizing data using ggplot2 | Fundamentals of Biological Data Analysis">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 Goal Introduce the package ggplot2, which is part of the tidyverse bundle. Learn how to use ggplot2 to produce publication-quality figures. Discuss the philosophical underpinnings of the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lecture 2 Visualizing data using ggplot2 | Fundamentals of Biological Data Analysis">
<meta name="twitter:description" content="2.1 Goal Introduce the package ggplot2, which is part of the tidyverse bundle. Learn how to use ggplot2 to produce publication-quality figures. Discuss the philosophical underpinnings of the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0.9000/transition.js"></script><script src="libs/bs3compat-0.3.0.9000/tabs.js"></script><script src="libs/bs3compat-0.3.0.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Biological Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Organization of the class</a></li>
<li><a class="" href="refresher.html"><span class="header-section-number">1</span> Refresher</a></li>
<li><a class="active" href="visualizing-data-using-ggplot2.html"><span class="header-section-number">2</span> Visualizing data using ggplot2</a></li>
<li><a class="" href="fundamentals-of-probability.html"><span class="header-section-number">3</span> Fundamentals of probability</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">4</span> Data wrangling</a></li>
<li><a class="" href="distributions-and-their-properties.html"><span class="header-section-number">5</span> Distributions and their properties</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">6</span> Hypothesis testing</a></li>
<li><a class="" href="likelihood-and-bayes.html"><span class="header-section-number">7</span> Likelihood and Bayes</a></li>
<li><a class="" href="review-of-linear-algebra.html"><span class="header-section-number">8</span> Review of linear algebra</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">9</span> Linear models</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">10</span> ANOVA</a></li>
<li><a class="" href="time-series-modeling-and-forecasting.html"><span class="header-section-number">11</span> Time series: modeling and forecasting</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">12</span> Generalized linear models</a></li>
<li><a class="" href="model-selection.html"><span class="header-section-number">13</span> Model Selection</a></li>
<li><a class="" href="principal-component-analysis.html"><span class="header-section-number">14</span> Principal Component Analysis</a></li>
<li><a class="" href="clustering.html"><span class="header-section-number">15</span> Clustering</a></li>
<li><a class="" href="building-phylogeneric-trees.html"><span class="header-section-number">16</span> Building phylogeneric trees</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="visualizing-data-using-ggplot2" class="section level1" number="2">
<h1>
<span class="header-section-number">Lecture 2</span> Visualizing data using <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#visualizing-data-using-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div id="goal-1" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Goal<a class="anchor" aria-label="anchor" href="#goal-1"><i class="fas fa-link"></i></a>
</h2>
<p>Introduce the package <code>ggplot2</code>, which is part of the <code>tidyverse</code> bundle. Learn how to use <code>ggplot2</code> to produce publication-quality figures. Discuss the philosophical underpinnings of the “Grammar of Graphics,” showcase the <code>ggplot2</code> syntax, produce examples of the different types of graphs. Learn how to change colors, legends, scales. Visualize histograms, barplots, scatterplots, etc.</p>
</div>
<div id="introduction-to-the-grammar-of-graphics" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Introduction to the Grammar of Graphics<a class="anchor" aria-label="anchor" href="#introduction-to-the-grammar-of-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>The most salient feature of scientific graphs should be clarity. Each figure should make crystal-clear a) what is being plotted; b) what are the axes; c) what do colors, shapes, and sizes represent; d) the message the figure wants to convey. Each figure is accompanied by a (sometimes long) caption, where the details can be explained further, but the main message should be clear from glancing at the figure (often, figures are the first thing editors and referees look at).</p>
<p>Many scientific publications contain very poor graphics: labels are missing, scales are unintelligible, there is no explanation of some graphical elements. Moreover, some color graphs are impossible to understand if printed in black and white, or difficult to discern for color-blind people.</p>
<p>Given the effort that you put into your science, you want to ensure that it is well presented and accessible. The investment to master some plotting software will be rewarded by pleasing graphics that convey a clear message.</p>
<p>In this section, we introduce <code>ggplot2</code>, a plotting package for <code>R</code> This package was developed by Hadley Wickham who contributed many important packages to <code>R</code> (all included in the <code>tidyverse</code> bundle we’re going to use for the reminder of the class). Unlike many other plotting systems, <code>ggplot2</code> is deeply rooted in a “philosophical” vision. The goal is to conceive a grammar for all graphical representation of data. Leland Wilkinson and collaborators proposed The Grammar of Graphics. It follows the idea of a well-formed sentence that is composed of a subject, a predicate, and an object. The Grammar of Graphics likewise aims at describing a well-formed graph by a grammar that captures a very wide range of statistical and scientific graphics. This might be more clear with an example – Take a simple two-dimensional scatterplot. How can we describe it? We have:</p>
<ul>
<li><p><strong>Data</strong> The data we want to plot.</p></li>
<li><p><strong>Mapping</strong> What part of the data is associated with a particular visual feature? For example: Which column is associated with the x-axis? Which with the y-axis? Which column corresponds to the shape or the color of the points? In <code>ggplot2</code> lingo, these are called <em>aesthetic mappings</em> (<code>aes</code>).</p></li>
<li><p><strong>Geometry</strong> Do we want to draw points? Lines? In <code>ggplot2</code> we speak of <em>geometries</em> (<code>geom</code>).</p></li>
<li><p><strong>Scale</strong> Do we want the sizes and shapes of the points to scale according to some value? Linearly? Logarithmically? Which palette
of colors do we want to use?</p></li>
<li><p><strong>Coordinate</strong> We need to choose a coordinate system (e.g., Cartesian, polar).</p></li>
<li><p><strong>Faceting</strong> Do we want to produce different panels, partitioning the data according to one (or more) of the variables?</p></li>
</ul>
<p>This basic grammar can be extended by adding statistical transformations of the data (e.g., regression, smoothing), multiple layers, adjustment of position (e.g., stack bars instead of plotting them side-by-side), annotations, and so on.</p>
<p>Exactly like in the grammar of a natural language, we can easily change the meaning of a “sentence” by adding or removing parts. Also, it is very easy to completely change the type of geometry if we are moving from say a histogram to a boxplot or a violin plot, as these types of plots are meant to describe one-dimensional distributions. Similarly, we can go from points to lines, changing one “word” in our code. Finally, the look and feel of the graphs is controlled by a theming system, separating the content from the presentation.</p>
</div>
<div id="basic-ggplot2" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Basic <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#basic-ggplot2"><i class="fas fa-link"></i></a>
</h2>
<p><code>ggplot2</code> ships with a simplified graphing function, called <code>qplot</code>. In this introduction we are not going to use it, and we concentrate instead on the function <code>ggplot</code>, which gives you complete control over your plotting. First, we need to load the package:</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p>To explore the features of <code>ggplot2</code>, we are going to use a data set detailing the total number of COVID cases and deaths in US counties. The data are provided by the <a href="https://github.com/nytimes/covid-19-data/blob/master/live/us-counties.csv">New York Times</a>.</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read the data</span>
<span class="co"># original URL https://github.com/nytimes/covid-19-data/raw/master/live/us-counties.csv</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://rb.gy/zr65gg"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   date = col_date(format = ""),
##   county = col_character(),
##   state = col_character(),
##   fips = col_character(),
##   cases = col_double(),
##   deaths = col_double(),
##   confirmed_cases = col_double(),
##   confirmed_deaths = col_double(),
##   probable_cases = col_double(),
##   probable_deaths = col_double()
## )</code></pre>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 10
##   date       county  state   fips  cases deaths confirmed_cases confirmed_deaths
##   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;
## 1 2021-11-10 Autauga Alabama 01001 10350    152            8440              134
## 2 2021-11-10 Baldwin Alabama 01003 37737    577           26477              393
## 3 2021-11-10 Barbour Alabama 01005  3620     79            2048               57
## 4 2021-11-10 Bibb    Alabama 01007  4301     92            3167               61
## 5 2021-11-10 Blount  Alabama 01009 10548    187            7928              153
## 6 2021-11-10 Bullock Alabama 01011  1520     44            1330               35
## # … with 2 more variables: probable_cases &lt;dbl&gt;, probable_deaths &lt;dbl&gt;</code></pre>
<p>we are going to work with <code>date</code>, <code>county</code>, <code>state</code>, <code>cases</code> and <code>deaths</code>.</p>
<p>Let’s select Illnois, and take only the counties with more than 10k cases (to have a less crowded graph):</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dti</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">[</span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"Illinois"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">cases</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<p>A particularity of <code>ggplot2</code> is that it accepts exclusively data organized in tables (a <code>data.frame</code> or a <code>tibble</code> object—more on tibbles later). Thus, all of your data needs to be converted into a data frame format for plotting.</p>
</div>
<div id="building-a-well-formed-graph" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Building a well-formed graph<a class="anchor" aria-label="anchor" href="#building-a-well-formed-graph"><i class="fas fa-link"></i></a>
</h2>
<p>For our first plot, we’re going to produce a barplot detailing how many cases have been reported in each County:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-84-1.png" width="672"></div>
<p>As you can see, nothing is drawn: we need to specify what we would like to associate to the <em>x</em> axis, and what to the <em>y</em> axis, etc. (i.e., we want to set as the <em>aesthetic mappings</em>). A barplot typically has classes on the <em>x</em> axis, while the <em>y</em> axis reports the counts in each class.</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">county</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-85-1.png" width="672"></div>
<p>Note that we concatenate pieces of our “sentence” using the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> sign! We’ve got the aestethic mappings figured out, but still no graph… we need to specify a geometry, i.e., the type of graph we want to produce. In this case, a barplot where the height of the bars is specified by the <code>y</code> value:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">county</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-86-1.png" width="672"></div>
<p>Because it is very difficult to see the labels, let’s swap the axes:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">county</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-87-1.png" width="672"></div>
<p>The graph shows that, naturally, the vast majority of cases was reported in Cook county. We have written a “well-formed sentence,” composed of <strong>data</strong> + <strong>mapping</strong> + <strong>geometry</strong>, and this is sufficient to produce a graph. We can add “adjectives” and “adverbs” to our graph, to make it clearer:</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">county</span>, <span class="va">cases</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span> <span class="op">+</span> <span class="co"># order labels according to cases</span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Number of COVID cases reported"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># x label</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Illinois County"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># y label</span>
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># transform the counts to logs</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="va">dti</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># main title (use current date)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-88-1.png" width="672"></div>
</div>
<div id="scatterplots" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"><i class="fas fa-link"></i></a>
</h2>
<p>Using <code>ggplot2</code>, one can produce very many types of graphs. The package works very well for 2D graphs (or 3D rendered in two dimensions), while it lack capabilities to draw proper 3D graphs, or networks.</p>
<p>The main feature of <code>ggplot2</code> is that you can tinker with your graph fairly easily, and with a common grammar. You don’t have to settle on a certain presentation of the data until you’re ready, and it is very easy to switch from one type of graph to another.</p>
<p>For example, let’s plot the number of cases vs. number of deaths:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># you can store the graph in a variable</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span><span class="op">)</span> <span class="co"># for a scatter plot, we need two aes mappings!</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="co"># draw points in a scatterplot</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">scale_x_sqrt</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_sqrt</span><span class="op">(</span><span class="op">)</span> <span class="co"># transform axes</span>
<span class="va">pl</span> <span class="co"># or show(pl)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-89-1.png" width="672"></div>
<p>Showing that number of daily cases and number of daily deaths are highly correlated (but it would be a stronger correlation if we were to plot past cases vs. current deaths).</p>
</div>
<div id="histograms-density-and-boxplots" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Histograms, density and boxplots<a class="anchor" aria-label="anchor" href="#histograms-density-and-boxplots"><i class="fas fa-link"></i></a>
</h2>
<p>It would be nice to see the distribution of the ratio deaths/cases. To do so, we can produce a histogram:</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span><span class="op">)</span>  
<span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.0025</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-90-1.png" width="672"></div>
<p>We can control the width of the bins by specifying:</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="co"># specify the number of bins</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-91-1.png" width="672"></div>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="co"># specify the bin width</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-91-2.png" width="672"></div>
<p>Let’s see whether the histograms differ between Illinois and Indiana:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># fill the bar colors by state</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-92-1.png" width="672"></div>
<p>To plot the histogram side by side, use</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># fill the bar colors by state</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-93-1.png" width="672"></div>
<p>Similarly, we can approximate the histogram using a density plot, which interpolates the bin height to create a smooth distribution:</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># fill by state</span>
  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-94-1.png" width="672"></div>
<p>To see the graph better, let’s make the coloring semi-transparent:</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># fill by state</span>
  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-95-1.png" width="672"></div>
<p>Showing a similar distribution for the death rate in the two states. For this type of comparison, the ideal graph to show is maybe a box-plot or a violin plot:</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, y <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># we need both x and y</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-96-1.png" width="672"></div>
<p>A boxplot shows the median (horizontal bar) as well as the inter-quartile range (box size goes from 25th to 75th percentile), as well as the typical range of the data (whiskers). The dots represent “outliers.” To show the full distribution, you can use a violin plot:</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Indiana"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, y <span class="op">=</span> <span class="va">deaths</span> <span class="op">/</span> <span class="va">cases</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="co"># we need both x and y</span>
  <span class="fu">geom_violin</span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-97-1.png" width="672"></div>
<p>Note that when we’re producing “similar” plots (e.g., histogram vs. density, box vs. violin, or any other plot sharing the same aesthetic mappings) changing a single word, we have changed the structure of the graph considerably!</p>
</div>
<div id="scales" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Scales<a class="anchor" aria-label="anchor" href="#scales"><i class="fas fa-link"></i></a>
</h2>
<p>We can use scales to determine how the aesthetic mappings are displayed. For example, we could set the <em>x</em> axis to be in logarithmic scale, or we can choose how the colors, shapes and sizes are used. <code>ggplot2</code> uses two types of scales: <code>continuous</code> scales are used for continuos variables (e.g., real numbers); <code>discrete</code> scales for variables that can only take a certain number of values (e.g., colors, shapes, sizes).</p>
<p>For example, let’s plot deaths vs. cases in our <code>dti</code> data set:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> 
<span class="va">pl</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-98-1.png" width="672"></div>
<p>We can change the scale of the <em>x</em> axis by calling:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="co"># log-log plot</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-99-1.png" width="672"></div>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">scale_x_sqrt</span><span class="op">(</span><span class="op">)</span> <span class="co"># sqrt of number of cases</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-99-2.png" width="672"></div>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="co"># from large to small</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-99-3.png" width="672"></div>
<p>Similarly, we can change the use of colors, points, etc.</p>
</div>
<div id="list-of-aesthetic-mappings" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> List of aesthetic mappings<a class="anchor" aria-label="anchor" href="#list-of-aesthetic-mappings"><i class="fas fa-link"></i></a>
</h2>
<p>We’ve seen some of the aesthetic mappings. Here’s a list of the main <code>aes</code>:</p>
<ul>
<li>
<code>x</code> what to use for <em>x</em> axis</li>
<li>
<code>y</code> what to use for <em>y</em> axis</li>
<li>
<code>color</code> the color of points and lines</li>
<li>
<code>fill</code> the color of shapes (e.g., boxes, bars, etc.)</li>
<li>
<code>size</code> the size of points, lines, etc.</li>
<li>
<code>shape</code> the shape of points</li>
<li>
<code>alpha</code> the level of transparency of the object</li>
<li>
<code>linetype</code> the type of line (e.g., solid, dashed, etc.)</li>
</ul>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># a more complex example</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span>, 
          color <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># note that the points with 0 cases or deaths will not work</span>
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-100-1.png" width="672"></div>
</div>
<div id="list-of-geometries" class="section level2" number="2.9">
<h2>
<span class="header-section-number">2.9</span> List of geometries<a class="anchor" aria-label="anchor" href="#list-of-geometries"><i class="fas fa-link"></i></a>
</h2>
<p>There are very many geometries; here are a few of the most useful ones:</p>
<ul>
<li>Lines: <code>geom_abline</code> (line given slope and intercept); <code>geom_hline</code>, <code>geom_vline</code> (horizontal, vertical line); <code>geom_line</code> (connect observation in scatterplot).</li>
<li>Bars: <code>geom_bar</code> (bar height is the count/sum); <code>geom_col</code> (bar heigts are provided by the data).</li>
<li>Boxes: <code>geom_boxplot</code>.</li>
<li>Distributions: <code>geom_violin</code> (like boxplots, but showing the density of the distribution); <code>geom_density</code> (density of 1D distribution), <code>geom_density2d</code> (density of bivariate distribution); <code>geom_histogram</code>, <code>geom_bin2d</code> (histograms).</li>
<li>Text: <code>geom_text</code>.</li>
<li>Smoothing function: <code>geom_smooth</code> (interpolates the points of a scatterplot).</li>
<li>Error bars: <code>geom_errorbar</code>.</li>
<li>Maps: <code>geom_map</code> (polygons from a reference map).</li>
</ul>
</div>
<div id="list-of-scales" class="section level2" number="2.10">
<h2>
<span class="header-section-number">2.10</span> List of scales<a class="anchor" aria-label="anchor" href="#list-of-scales"><i class="fas fa-link"></i></a>
</h2>
<p>There are also very many scales. Here are a few:</p>
<ul>
<li>
<code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code> control labels and ranges of the axes.</li>
<li>
<code>scale_alpha</code> transparency of the points/shapes.</li>
<li>
<code>scale_color</code> (many options) colors of points and lines.</li>
<li>
<code>scale_fill</code> (many options) colors of boxes, bars and shapes.</li>
<li>
<code>scale_shape</code> shape of the points.</li>
<li>
<code>scale_linetype</code> type of lines.</li>
<li>
<code>scale_size</code> size of points and lines.</li>
<li>
<code>scale_x</code>, <code>scale_y</code> (many options) transformations of the axes.</li>
</ul>
</div>
<div id="themes" class="section level2" number="2.11">
<h2>
<span class="header-section-number">2.11</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h2>
<p>Themes allow you to manipulate the look and feel of a graph with just one command. The package <code>ggthemes</code> extends the themes collection of <code>ggplot2</code> considerably. For example:</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># to install, type install.packages("ggthemes") in the console</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dti</span><span class="op">)</span> <span class="op">+</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="co"># white background</span>
<span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_economist.html">theme_economist</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># like in the magazine "The Economist"</span>
<span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_wsj.html">theme_wsj</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># like "The Wall Street Journal"</span></code></pre></div>
</div>
<div id="faceting" class="section level2" number="2.12">
<h2>
<span class="header-section-number">2.12</span> Faceting<a class="anchor" aria-label="anchor" href="#faceting"><i class="fas fa-link"></i></a>
</h2>
<p>In many cases, we would like to produce a multi-panel graph, in which each panel shows the data for a certain combination of parameters. In <code>ggplot2</code> this is called <em>faceting</em>: the command <code>facet_grid</code> is used when you want to produce a grid of panels, in which all the panels in the same row (or column) have axes-ranges in common; <code>facet_wrap</code> is used when the different panels do not necessarily have axes-ranges in common.</p>
<p>For example:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">[</span><span class="va">dt</span><span class="op">$</span><span class="va">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Illinois"</span>, <span class="st">"Missouri"</span>, <span class="st">"Wisconsin"</span>, <span class="st">"Indiana"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span>, colour <span class="op">=</span> <span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">state</span><span class="op">)</span>
<span class="va">pl</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-102-1.png" width="672"></div>
<p>Let’s add a line separating showing the best-fit line:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span>
<span class="va">pl</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-103-1.png" width="672"></div>
<p>Make ranges on <em>x</em> and <em>y</em> axes equal, and add the 1:1 line:</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">pl</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-104-1.png" width="672"></div>
</div>
<div id="setting-features" class="section level2" number="2.13">
<h2>
<span class="header-section-number">2.13</span> Setting features<a class="anchor" aria-label="anchor" href="#setting-features"><i class="fas fa-link"></i></a>
</h2>
<p>Often, you want to simply set a feature (e.g., the color of the points, or their shape), rather than using it to display information (i.e., mapping some aestethic). In such cases, simply declare the feature outside the <code>aes</code>:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cases</span>, y <span class="op">=</span> <span class="va">deaths</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span>
<span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-105-1.png" width="672"></div>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-105-2.png" width="672"></div>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-105-3.png" width="672"></div>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-105-4.png" width="672"></div>
</div>
<div id="saving-graphs" class="section level2" number="2.14">
<h2>
<span class="header-section-number">2.14</span> Saving graphs<a class="anchor" aria-label="anchor" href="#saving-graphs"><i class="fas fa-link"></i></a>
</h2>
<p>You can either save graphs as done normally in <code>R</code>:</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save to pdf format</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"my_output.pdf"</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># save to svg format</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">svg</a></span><span class="op">(</span><span class="st">"my_output.svg"</span>, width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>or use the function <code>ggsave</code></p>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save current graph</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="st">"my_output.pdf"</span><span class="op">)</span>
<span class="co"># save a graph stored in ggplot object</span>
<span class="fu">ggsave</span><span class="op">(</span>plot <span class="op">=</span> <span class="va">my_plot</span>, filename <span class="op">=</span> <span class="st">"my_output.svg"</span><span class="op">)</span></code></pre></div>
</div>
<div id="multiple-layers" class="section level2" number="2.15">
<h2>
<span class="header-section-number">2.15</span> Multiple layers<a class="anchor" aria-label="anchor" href="#multiple-layers"><i class="fas fa-link"></i></a>
</h2>
<p>You can overlay different plots. To do so, however, they must share some of the aesthetic mappings.
The simplest case is that in which you have only one dataset:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">state</span>, x <span class="op">=</span> <span class="va">cases</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">state</span>, x <span class="op">=</span> <span class="va">deaths</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"cases (black), deaths (red)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="BIOS_26318_2020_files/figure-html/unnamed-chunk-108-1.png" width="672"></div>
</div>
<div id="try-on-your-own-data" class="section level2" number="2.16">
<h2>
<span class="header-section-number">2.16</span> Try on your own data!<a class="anchor" aria-label="anchor" href="#try-on-your-own-data"><i class="fas fa-link"></i></a>
</h2>
<p>Now that you’re familiar with <code>ggplot2</code>, try producing some meaningful plots for your own data.</p>
</div>
<div id="resources-1" class="section level2" number="2.17">
<h2>
<span class="header-section-number">2.17</span> Resources<a class="anchor" aria-label="anchor" href="#resources-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="https://hackr.io/tutorial/r-for-data-science">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">Tidyverse reference website</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">Data Visualization Cheat Sheet</a></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="refresher.html"><span class="header-section-number">1</span> Refresher</a></div>
<div class="next"><a href="fundamentals-of-probability.html"><span class="header-section-number">3</span> Fundamentals of probability</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualizing-data-using-ggplot2"><span class="header-section-number">2</span> Visualizing data using ggplot2</a></li>
<li><a class="nav-link" href="#goal-1"><span class="header-section-number">2.1</span> Goal</a></li>
<li><a class="nav-link" href="#introduction-to-the-grammar-of-graphics"><span class="header-section-number">2.2</span> Introduction to the Grammar of Graphics</a></li>
<li><a class="nav-link" href="#basic-ggplot2"><span class="header-section-number">2.3</span> Basic ggplot2</a></li>
<li><a class="nav-link" href="#building-a-well-formed-graph"><span class="header-section-number">2.4</span> Building a well-formed graph</a></li>
<li><a class="nav-link" href="#scatterplots"><span class="header-section-number">2.5</span> Scatterplots</a></li>
<li><a class="nav-link" href="#histograms-density-and-boxplots"><span class="header-section-number">2.6</span> Histograms, density and boxplots</a></li>
<li><a class="nav-link" href="#scales"><span class="header-section-number">2.7</span> Scales</a></li>
<li><a class="nav-link" href="#list-of-aesthetic-mappings"><span class="header-section-number">2.8</span> List of aesthetic mappings</a></li>
<li><a class="nav-link" href="#list-of-geometries"><span class="header-section-number">2.9</span> List of geometries</a></li>
<li><a class="nav-link" href="#list-of-scales"><span class="header-section-number">2.10</span> List of scales</a></li>
<li><a class="nav-link" href="#themes"><span class="header-section-number">2.11</span> Themes</a></li>
<li><a class="nav-link" href="#faceting"><span class="header-section-number">2.12</span> Faceting</a></li>
<li><a class="nav-link" href="#setting-features"><span class="header-section-number">2.13</span> Setting features</a></li>
<li><a class="nav-link" href="#saving-graphs"><span class="header-section-number">2.14</span> Saving graphs</a></li>
<li><a class="nav-link" href="#multiple-layers"><span class="header-section-number">2.15</span> Multiple layers</a></li>
<li><a class="nav-link" href="#try-on-your-own-data"><span class="header-section-number">2.16</span> Try on your own data!</a></li>
<li><a class="nav-link" href="#resources-1"><span class="header-section-number">2.17</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Biological Data Analysis</strong>" was written by Dmitry Kondrashov and Stefano Allesina. It was last built on 2021-11-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
